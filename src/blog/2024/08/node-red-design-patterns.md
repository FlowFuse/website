---
title: "Building Better Node-RED Flows: A Comprehensive Guide to Design Patterns and Best Practices"
subtitle: Explore essential and advanced design patterns to enhance your Node-RED workflows
description: This guide provides an in-depth look at Node-RED design patterns, including to help you build more robust and efficient automation flows quickly.
date: 2024-08-02
authors: ["sumit-shinde"]
image: 
tags:
   - post
   - nodered
   - node-red design patterns
   - node-red best practices
---

When building flows in Node-RED, have you ever wondered how to make your flows more efficient, reliable, and easier to manage? Just like in traditional programming, design patterns can offer reusable solutions to common problems, helping you create better workflows with less effort.

In this guide, we’ll explore advanced design patterns for Node-RED. These patterns will help you build more robust and efficient Node-RED flows.

## Understanding Design Patterns

Before diving into the specific Node-RED design patterns, it’s important to grasp what design patterns are and why they matter.

**Design Patterns** are proven solutions to common problems in software design. They provide a template for how to solve specific issues and improve the design of your system. Originating from object-oriented programming, these patterns help in creating more efficient, maintainable, and scalable systems by providing reusable and adaptable solutions.

### Benefits of Design Patterns:

- Consistency: They help standardize coding practices and workflows, making it easier for teams to collaborate.
- Efficiency: They offer ready-made solutions that can be adapted to your needs, saving time and effort.
- Scalability: They assist in building systems that can grow and evolve without extensive rework.

## Node-RED Design patterns

### UI Pattern

User interface (UI) design patterns are reusable components that designers use to address common problems in user interface design. In this section, I have covered some of these design patterns. You can explore more options on the [FlowFuse dashboard(https://dashboard-demos.flowfuse.cloud/dashboard/)], where each page offers solutions for achieving unique UI components, you can read this [amazing docs](https://dashboard.flowfuse.com/getting-started.html#design-patterns) on data synchronization and user management patterns for FlowFuse Dashboard, We may also cover more ui design patterns in future blog posts.

#### Navigation Patterns

A pattern for organizing and presenting navigation options in a way that helps users find and access different sections of an application or website.

{% renderFlow %}
[{"id":"51911fdf0c8e9863","type":"group","z":"4905164f6a425bac","name":"Navigation Patterns","style":{"label":true},"nodes":["bca8670a789efedc","c6eb9e54e5b0be50","6b24b0538d7f69ed","87099001b93a250b"],"x":194,"y":119,"w":612,"h":242},{"id":"bca8670a789efedc","type":"ui-control","z":"4905164f6a425bac","g":"51911fdf0c8e9863","name":"","ui":"c385dfc590b1308d","events":"all","x":520,"y":280,"wires":[[]]},{"id":"c6eb9e54e5b0be50","type":"ui-button","z":"4905164f6a425bac","g":"51911fdf0c8e9863","group":"0c48f8d560157d3c","name":"","label":"Navigate to Page 2","order":1,"width":"2","height":"1","emulateClick":false,"tooltip":"","color":"","bgcolor":"","className":"","icon":"","iconPosition":"left","payload":"Page 2","payloadType":"str","topic":"topic","topicType":"msg","buttonColor":"","textColor":"","iconColor":"","x":330,"y":220,"wires":[["bca8670a789efedc"]]},{"id":"6b24b0538d7f69ed","type":"ui-button","z":"4905164f6a425bac","g":"51911fdf0c8e9863","group":"cbf889af851a9c28","name":"","label":"Navigate to Page 1","order":1,"width":"2","height":"1","emulateClick":false,"tooltip":"","color":"","bgcolor":"","className":"","icon":"","iconPosition":"left","payload":"Page 1","payloadType":"str","topic":"topic","topicType":"msg","buttonColor":"","textColor":"","iconColor":"","x":330,"y":320,"wires":[["bca8670a789efedc"]]},{"id":"87099001b93a250b","type":"comment","z":"4905164f6a425bac","g":"51911fdf0c8e9863","name":"Using UI control widgets for programmatically navigating through different pages","info":"","x":500,"y":160,"wires":[]},{"id":"c385dfc590b1308d","type":"ui-base","name":"Dashboard","path":"/dashboard","includeClientData":true,"acceptsClientConfig":["ui-notification","ui-control","ui-button"],"showPathInSidebar":false,"showPageTitle":false,"navigationStyle":"temporary","titleBarStyle":"default"},{"id":"0c48f8d560157d3c","type":"ui-group","name":"My Group","page":"d0def7a91d3b7aa1","width":"12","height":"1","order":1,"showTitle":false,"className":"","visible":"true","disabled":"false"},{"id":"cbf889af851a9c28","type":"ui-group","name":"My Group","page":"50b47ba37702a020","width":"12","height":"1","order":1,"showTitle":false,"className":"","visible":"true","disabled":"false"},{"id":"d0def7a91d3b7aa1","type":"ui-page","name":"Page 1","ui":"c385dfc590b1308d","path":"/1","icon":"home","layout":"grid","theme":"6be033291dd76b17","order":1,"className":"","visible":false,"disabled":false},{"id":"50b47ba37702a020","type":"ui-page","name":"Page 2","ui":"c385dfc590b1308d","path":"/2","icon":"home","layout":"grid","theme":"6be033291dd76b17","order":2,"className":"","visible":true,"disabled":false},{"id":"6be033291dd76b17","type":"ui-theme","name":"Default Theme","colors":{"surface":"#202c34","primary":"#202c34","bgPage":"#eeeeee","groupBg":"#ffffff","groupOutline":"#ffffff"},"sizes":{"pagePadding":"12px","groupGap":"12px","groupBorderRadius":"4px","widgetGap":"12px","density":"default"}}]
{% endrenderFlow %}

In the above flow, you can see how to navigate through different pages of the dashboard programmatically. The FlowFuse Dashboard also allows you to control the view of groups along with pages. For more information, refer to the [UI-Control documentation](https://dashboard.flowfuse.com/).

#### Form Validation and Feedback Pattern

The form validation pattern ensures data integrity by checking user input against predefined criteria. In the example flow, a phone number is validated using a regular expression to confirm its format before processing.

The feedback pattern informs users of any errors or missing information. If the validation fails, a notification is displayed, guiding the user to correct the input.

Together, these patterns help maintain accurate data and improve the user experience by providing clear, actionable feedback.

{% renderFlow %}
[{"id":"8c9734c03fbd8ace","type":"group","z":"4905164f6a425bac","name":"Form Validation Pattern","style":{"label":true},"nodes":["f7c9f66760181a5f","dd8fdd1633db8123","9f54bf873e6bedbe","8e0b4f8d73e0a86f","da8ad918e7a1e076"],"x":114,"y":119,"w":972,"h":162},{"id":"f7c9f66760181a5f","type":"ui-form","z":"4905164f6a425bac","g":"8c9734c03fbd8ace","name":"","group":"0c48f8d560157d3c","label":"","order":1,"width":0,"height":0,"options":[{"label":"Name","key":"name","type":"text","required":true,"rows":null},{"label":"Phone","key":"phone","type":"number","required":true,"rows":null}],"formValue":{"name":"","phone":""},"payload":"","submit":"submit","cancel":"clear","resetOnSubmit":true,"topic":"topic","topicType":"msg","splitLayout":"","className":"","passthru":false,"x":190,"y":200,"wires":[["dd8fdd1633db8123"]]},{"id":"dd8fdd1633db8123","type":"switch","z":"4905164f6a425bac","g":"8c9734c03fbd8ace","name":"Does it match the phone number regex?","property":"payload.phone","propertyType":"msg","rules":[{"t":"regex","v":"^(?:\\+?(\\d{1,3}))?[-.\\s]?(\\(?\\d{1,5}\\)?)[-.\\s]?(\\d{1,4})[-.\\s]?(\\d{1,4})[-.\\s]?(\\d{1,9})$","vt":"str","case":false},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":460,"y":200,"wires":[["9f54bf873e6bedbe"],["8e0b4f8d73e0a86f"]]},{"id":"9f54bf873e6bedbe","type":"debug","z":"4905164f6a425bac","g":"8c9734c03fbd8ace","name":"Print on Debug panel","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":820,"y":160,"wires":[]},{"id":"8e0b4f8d73e0a86f","type":"change","z":"4905164f6a425bac","g":"8c9734c03fbd8ace","name":"Set notification text","rules":[{"t":"set","p":"payload","pt":"msg","to":"Please enter the correct phone number","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":750,"y":240,"wires":[["da8ad918e7a1e076"]]},{"id":"da8ad918e7a1e076","type":"ui-notification","z":"4905164f6a425bac","g":"8c9734c03fbd8ace","ui":"c385dfc590b1308d","position":"top right","colorDefault":true,"color":"#000000","displayTime":"3","showCountdown":true,"outputs":1,"allowDismiss":true,"dismissText":"Close","allowConfirm":false,"confirmText":"Confirm","raw":false,"className":"","name":"","x":970,"y":240,"wires":[[]]},{"id":"0c48f8d560157d3c","type":"ui-group","name":"My Group","page":"d0def7a91d3b7aa1","width":"12","height":"1","order":1,"showTitle":false,"className":"","visible":"true","disabled":"false"},{"id":"c385dfc590b1308d","type":"ui-base","name":"Dashboard","path":"/dashboard","includeClientData":true,"acceptsClientConfig":["ui-notification","ui-control","ui-button"],"showPathInSidebar":false,"showPageTitle":false,"navigationStyle":"temporary","titleBarStyle":"default"},{"id":"d0def7a91d3b7aa1","type":"ui-page","name":"Page 1","ui":"c385dfc590b1308d","path":"/1","icon":"home","layout":"grid","theme":"6be033291dd76b17","order":1,"className":"","visible":false,"disabled":false},{"id":"6be033291dd76b17","type":"ui-theme","name":"Default Theme","colors":{"surface":"#202c34","primary":"#202c34","bgPage":"#eeeeee","groupBg":"#ffffff","groupOutline":"#ffffff"},"sizes":{"pagePadding":"12px","groupGap":"12px","groupBorderRadius":"4px","widgetGap":"12px","density":"default"}}]
{% endrenderFlow %}

In the flow above, we demonstrate how to validate input submitted through a form. If the input meets the criteria, it is processed; otherwise, a notification is displayed to prompt the user to correct any errors. Note that basic validation, such as checking for required fields and ensuring correct data types (e.g., numeric values), is already handled by default by the FlowFuse Dashboard form widget. For further details, refer to the [UI-Form documentation](https://dashboard.flowfuse.com/nodes/widgets/ui-form.html).

### While Pattern

The while pattern is a way to repeatedly run a piece of code as long as a certain condition is true. It stops running when the condition becomes false. It is commonly used in software development to handle situations where the number of iterations is not predetermined and depends on dynamic conditions.

{% renderFlow %}
[{"id":"eb4cd99e1a78f7e8","type":"group","z":"4905164f6a425bac","name":"While pattern","style":{"label":true},"nodes":["2e73c592.d18c3a","b70d1dec.48f2e","64c1427a.9b3ebc","434af4eb.bcb50c","4184c9e2.be7b38","513b77da.aec488","1b603a4c.e49fc6","1999ecc8.e66613","dd46beea.22b94","3f1e738b.c0e18c","8498d15ec3630e42","617a97c01059efa4","477b80c0f0e3823f"],"x":154,"y":279,"w":902.9999694824219,"h":232.8690242767334},{"id":"2e73c592.d18c3a","type":"switch","z":"4905164f6a425bac","g":"eb4cd99e1a78f7e8","name":"i<11","property":"i","propertyType":"msg","rules":[{"t":"lt","v":"11","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":567.0000305175781,"y":420.0000066757202,"wires":[["477b80c0f0e3823f"],["3f1e738b.c0e18c"]]},{"id":"b70d1dec.48f2e","type":"debug","z":"4905164f6a425bac","g":"eb4cd99e1a78f7e8","name":"End","active":true,"console":"false","complete":"payload","x":941.0000305175781,"y":470.00001525878906,"wires":[]},{"id":"64c1427a.9b3ebc","type":"debug","z":"4905164f6a425bac","g":"eb4cd99e1a78f7e8","name":"Output \"i\"","active":true,"console":"false","complete":"payload","x":947.3999938964844,"y":420.066650390625,"wires":[]},{"id":"434af4eb.bcb50c","type":"inject","z":"4905164f6a425bac","g":"eb4cd99e1a78f7e8","name":"Start","repeat":"","crontab":"","once":false,"topic":"","payload":"","payloadType":"date","x":250,"y":420,"wires":[["8498d15ec3630e42"]]},{"id":"4184c9e2.be7b38","type":"comment","z":"4905164f6a425bac","g":"eb4cd99e1a78f7e8","name":"while pattern","info":"","x":302.16668701171875,"y":324.5556182861328,"wires":[]},{"id":"513b77da.aec488","type":"comment","z":"4905164f6a425bac","g":"eb4cd99e1a78f7e8","name":"Print 2's table","info":"","x":960.9999694824219,"y":379.1666259765625,"wires":[]},{"id":"1b603a4c.e49fc6","type":"comment","z":"4905164f6a425bac","g":"eb4cd99e1a78f7e8","name":"loop while i < 4 is true ↑","info":"","x":520.6666870117188,"y":460.66664123535156,"wires":[]},{"id":"1999ecc8.e66613","type":"comment","z":"4905164f6a425bac","g":"eb4cd99e1a78f7e8","name":"Start the incremented value at 1 ↓","info":"","x":366.16668701171875,"y":378.1667022705078,"wires":[]},{"id":"dd46beea.22b94","type":"comment","z":"4905164f6a425bac","g":"eb4cd99e1a78f7e8","name":"← increments the value \"i\"","info":"","x":870.5000305175781,"y":324.3333740234375,"wires":[]},{"id":"3f1e738b.c0e18c","type":"template","z":"4905164f6a425bac","g":"eb4cd99e1a78f7e8","name":"Loop Finished","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Table Finished","x":722.2381057739258,"y":470.8690242767334,"wires":[["b70d1dec.48f2e"]]},{"id":"8498d15ec3630e42","type":"change","z":"4905164f6a425bac","g":"eb4cd99e1a78f7e8","name":"initilized i ","rules":[{"t":"set","p":"i","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":400,"y":420,"wires":[["2e73c592.d18c3a"]]},{"id":"617a97c01059efa4","type":"change","z":"4905164f6a425bac","g":"eb4cd99e1a78f7e8","name":"i++","rules":[{"t":"set","p":"i","pt":"msg","to":"i + 1","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":320,"wires":[["2e73c592.d18c3a"]]},{"id":"477b80c0f0e3823f","type":"change","z":"4905164f6a425bac","g":"eb4cd99e1a78f7e8","name":"initilized i ","rules":[{"t":"set","p":"payload","pt":"msg","to":"i * 2","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":740,"y":400,"wires":[["64c1427a.9b3ebc","617a97c01059efa4"]]}]
{% endrenderFlow %}

In the above flow, we have demonstrated a while loop using Node-RED to print the multiplication table of 2. The flow initializes a variable i, checks if it is less than 11, and prints the result of i * 2 for each iteration until i reaches 11.

### Sequence Pattern

The sequence pattern is a way of doing things step by step in a specific order. Each step happens one after the other, following the previous one to complete the task. Node-RED by default follows this sequential approach, executing each step in the order it’s arranged.

{% renderFlow %}
[{"id":"fa73bdbb46a92acf","type":"group","z":"4905164f6a425bac","name":"Sequence pattern","style":{"label":true},"nodes":["d7939db8.286c6","581b04d0.a7e4fc","433d6e90.bcc29","35b9042df82b5291","6daa286d7a414a3d","0a8e968af410a9de"],"x":94,"y":219,"w":932,"h":322},{"id":"d7939db8.286c6","type":"comment","z":"4905164f6a425bac","g":"fa73bdbb46a92acf","name":"Sequence pattern","info":"","x":230,"y":260,"wires":[]},{"id":"581b04d0.a7e4fc","type":"debug","z":"4905164f6a425bac","g":"fa73bdbb46a92acf","name":"Result = 727","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":910,"y":500,"wires":[]},{"id":"433d6e90.bcc29","type":"inject","z":"4905164f6a425bac","g":"fa73bdbb46a92acf","name":"Calculate the sum of two values","repeat":"","crontab":"","once":false,"topic":"","payload":"","payloadType":"date","x":270,"y":320,"wires":[["35b9042df82b5291"]]},{"id":"35b9042df82b5291","type":"change","z":"4905164f6a425bac","g":"fa73bdbb46a92acf","name":"Set first value to payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"327","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":530,"y":320,"wires":[["6daa286d7a414a3d"]]},{"id":"6daa286d7a414a3d","type":"change","z":"4905164f6a425bac","g":"fa73bdbb46a92acf","name":"Save initial value to temp and set second value to payload","rules":[{"t":"set","p":"temp","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"400","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":380,"wires":[["0a8e968af410a9de"]]},{"id":"0a8e968af410a9de","type":"change","z":"4905164f6a425bac","g":"fa73bdbb46a92acf","name":"Perform the calculation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload + temp","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":800,"y":440,"wires":[["581b04d0.a7e4fc"]]}]
{% endrenderFlow %}

In the flow above, we demonstrate how the Aggregator pattern can be used to calculate the average of data from multiple sensors that are reading values every 2 seconds. This flow utilizes the `node-red-contrib-aggregator` node, so make sure to install it. The aggregator node also supports calculating geometric mean, harmonic mean, median, minimum, and maximum values.

### Aggregator pattern

The Aggregator pattern is used to combine and process data from multiple sources into a single, unified result. It centralizes data management, making it easier to handle and maintain. By consolidating information, it simplifies interactions and reduces complexity, often performing calculations or transformations on the collected data to provide a comprehensive output. This pattern is useful in scenarios where multiple data points need to be gathered and analyzed together.

{% renderFlow %}
[{"id":"6fbdfafb46d2a8dd","type":"group","z":"4905164f6a425bac","name":"Aggregator pattern","style":{"label":true},"nodes":["59d42f317d59820d","b3ffc363a45cd9ae","ead032e3945e21d7","4bc98d90bf229633","ceea99a4d8d5f91e","6c6eb00e1b2242a6","5102f6ca17cf686d","7bdfbe3ed0ae3546"],"x":154,"y":139,"w":992,"h":402},{"id":"59d42f317d59820d","type":"inject","z":"4905164f6a425bac","g":"6fbdfafb46d2a8dd","name":"Sensor 1","props":[{"p":"payload"}],"repeat":"2","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"56","payloadType":"num","x":270,"y":180,"wires":[["ead032e3945e21d7"]]},{"id":"b3ffc363a45cd9ae","type":"inject","z":"4905164f6a425bac","g":"6fbdfafb46d2a8dd","name":"Sensor 2","props":[{"p":"payload"}],"repeat":"2","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"40","payloadType":"num","x":270,"y":260,"wires":[["ead032e3945e21d7"]]},{"id":"ead032e3945e21d7","type":"aggregator","z":"4905164f6a425bac","g":"6fbdfafb46d2a8dd","name":"Combine all sensor data and calculate the average.","topic":"","intervalCount":"2","intervalUnits":"s","submitIncompleteInterval":true,"submitPerTopic":false,"aggregationType":"mean","x":690,"y":340,"wires":[["7bdfbe3ed0ae3546"]]},{"id":"4bc98d90bf229633","type":"inject","z":"4905164f6a425bac","g":"6fbdfafb46d2a8dd","name":"Sensor 3","props":[{"p":"payload"}],"repeat":"2","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"78","payloadType":"num","x":270,"y":320,"wires":[["ead032e3945e21d7"]]},{"id":"ceea99a4d8d5f91e","type":"inject","z":"4905164f6a425bac","g":"6fbdfafb46d2a8dd","name":"Sensor 4","props":[{"p":"payload"}],"repeat":"2","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"40","payloadType":"num","x":270,"y":380,"wires":[["ead032e3945e21d7"]]},{"id":"6c6eb00e1b2242a6","type":"inject","z":"4905164f6a425bac","g":"6fbdfafb46d2a8dd","name":"Sensor 5","props":[{"p":"payload"}],"repeat":"2","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"21","payloadType":"num","x":270,"y":440,"wires":[["ead032e3945e21d7"]]},{"id":"5102f6ca17cf686d","type":"inject","z":"4905164f6a425bac","g":"6fbdfafb46d2a8dd","name":"Sensor 6","props":[{"p":"payload"}],"repeat":"2","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"78","payloadType":"num","x":270,"y":500,"wires":[["ead032e3945e21d7"]]},{"id":"7bdfbe3ed0ae3546","type":"debug","z":"4905164f6a425bac","g":"6fbdfafb46d2a8dd","name":"Average","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1040,"y":340,"wires":[]}]
{% endrenderFlow %}

In the flow below, we demonstrate how the Aggregator pattern can be used to calculate the average of data from multiple sensors that are reading values every 2 seconds. This flow utilizes the `node-red-contrib-aggregator` node, so make sure to install it. The aggregator node also supports calculating geometric mean, harmonic mean, median, minimum, and maximum values.

### Separator pattern

The Separator pattern in Node-RED is used to organize and manage different types of data by sending them through separate outputs. This approach allows you to handle and process each type of data independently, making it easier to manage different parts of your flow efficiently.

{% renderFlow %}
[{"id":"294c1270cd838a03","type":"group","z":"4905164f6a425bac","name":"Separator pattern","style":{"label":true},"nodes":["7f97d934625b610f","fcf37a8b320a2bf8","95450728d55ced07","a93c74a8193cdc88","f27644b7337cddb4","d1f4506964aa6acb"],"x":174,"y":179,"w":912,"h":202},{"id":"7f97d934625b610f","type":"inject","z":"4905164f6a425bac","g":"294c1270cd838a03","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":320,"y":300,"wires":[["95450728d55ced07"]]},{"id":"fcf37a8b320a2bf8","type":"debug","z":"4905164f6a425bac","g":"294c1270cd838a03","name":"Date","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":830,"y":260,"wires":[]},{"id":"95450728d55ced07","type":"function","z":"4905164f6a425bac","g":"294c1270cd838a03","name":"Split Date Components","func":"//$PROMPT: give function that seprates the output of input (moment) for date , month year  and i mean that much function outputs  \nconst inputDate = msg.payload\nconst date = moment(inputDate)\n\nconst day = date.date()\nconst month = date.month() + 1 // month is 0-indexed\nconst year = date.year()\n\nreturn [{ payload: day }, { payload: month }, { payload: year }]","outputs":3,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[{"var":"moment","module":"moment"}],"x":590,"y":300,"wires":[["fcf37a8b320a2bf8"],["a93c74a8193cdc88"],["f27644b7337cddb4"]]},{"id":"a93c74a8193cdc88","type":"debug","z":"4905164f6a425bac","g":"294c1270cd838a03","name":"Month","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":830,"y":300,"wires":[]},{"id":"f27644b7337cddb4","type":"debug","z":"4905164f6a425bac","g":"294c1270cd838a03","name":"Year","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":830,"y":340,"wires":[]},{"id":"d1f4506964aa6acb","type":"comment","z":"4905164f6a425bac","g":"294c1270cd838a03","name":"Split the timestamp into date, month, and year, store them in separate payloads, and send them through their respective outputs.","info":"","x":630,"y":220,"wires":[]}]
{% endrenderFlow %}

In the above flow, we have demonstrated how you can use the Separator Pattern to process timestamp and send through separate outputs. In this example, the date is split into day, month, and year from the timestamp. Each is sent through its respective output.

### Mapreduce pattern

MapReduce is a pattern used to process and generate large datasets by dividing the task into two main patterns: "Map," which processes data, and "Reduce," which aggregates the results to produce output.

{% renderFlow %}
[{"id":"e0b8484fe0b27abd","type":"group","z":"4905164f6a425bac","name":"Mapreduce pattern","style":{"label":true},"nodes":["46d57c999befeffa","d5f7fe8de928a627","a6f30da143093a3c","6e52e304d031d10f","2e5d343ed7617a61"],"x":554,"y":399,"w":872,"h":82},{"id":"46d57c999befeffa","type":"function","z":"4905164f6a425bac","g":"e0b8484fe0b27abd","name":"Word Count","func":"const wordCount = {}\n\nif (Array.isArray(msg.payload)) {\n    msg.payload.forEach(word => {\n        if (typeof word === 'string') {\n            wordCount[word] = (wordCount[word] || 0) + 1\n        }\n    })\n}\n\nmsg.payload = wordCount\nreturn msg","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1150,"y":440,"wires":[["2e5d343ed7617a61"]]},{"id":"d5f7fe8de928a627","type":"inject","z":"4905164f6a425bac","g":"e0b8484fe0b27abd","name":"Send text","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"Once upon a time in a quiet village nestled between rolling hills, there lived a young girl named Lily. She was known for her boundless curiosity and a heart full of dreams. Every day after her chores, she would wander into the forest, fascinated by the mysteries it held. The villagers warned her of the enchanted glade deep within the woods, a place where time stood still and strange things happened. But Lily's curiosity only grew stronger.  One crisp autumn morning, as the leaves crunched beneath her feet, Lily ventured farther than she ever had before. The sunlight danced through the trees, leading her to a clearing she had never seen. In the center of the glade stood an ancient oak tree, its branches twisted into the sky, its roots sprawling out like fingers grasping the earth. At the base of the tree was a small, glowing pool, its water shimmering with colors that seemed to be from another world.","payloadType":"str","x":660,"y":440,"wires":[["a6f30da143093a3c"]]},{"id":"a6f30da143093a3c","type":"split","z":"4905164f6a425bac","g":"e0b8484fe0b27abd","name":"","splt":" ","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":810,"y":440,"wires":[["6e52e304d031d10f"]]},{"id":"6e52e304d031d10f","type":"join","z":"4905164f6a425bac","g":"e0b8484fe0b27abd","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"2","count":"","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":970,"y":440,"wires":[["46d57c999befeffa"]]},{"id":"2e5d343ed7617a61","type":"debug","z":"4905164f6a425bac","g":"e0b8484fe0b27abd","name":"debug 1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1320,"y":440,"wires":[]}]
{% endrenderFlow %}

In the above flow, we demonstrated how to calculate the number of times each word occurs in a paragraph using the mapreduce pattern. First, we split the paragraph into words, then converted it into an array, and finally used a function node to calculate the word count and created the object.

### Batch Processing Pattern

The batch processing pattern involves collecting and processing data in groups, or batches, rather than individually. This approach is particularly useful for handling large volumes of data or tasks that can be processed collectively rather than in real-time.

{% renderFlow %}
[{"id":"0ace327eb24d43ce","type":"group","z":"4905164f6a425bac","name":"Batch Processing Pattern","style":{"label":true},"nodes":["inject_subject","3d7c2b5054a4240c","507a68a3840b0349","572d46ad4a1b7fb9"],"x":534,"y":419,"w":832,"h":82},{"id":"inject_subject","type":"inject","z":"4905164f6a425bac","g":"0ace327eb24d43ce","name":"Sensor 1","props":[{"p":"payload"}],"repeat":"1","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"$random() * 100","payloadType":"jsonata","x":650,"y":460,"wires":[["3d7c2b5054a4240c"]]},{"id":"3d7c2b5054a4240c","type":"batch","z":"4905164f6a425bac","g":"0ace327eb24d43ce","name":"","mode":"interval","count":10,"overlap":0,"interval":"5","allowEmptySequence":false,"topics":[],"x":860,"y":460,"wires":[["572d46ad4a1b7fb9"]]},{"id":"507a68a3840b0349","type":"debug","z":"4905164f6a425bac","g":"0ace327eb24d43ce","name":"debug 1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1260,"y":460,"wires":[]},{"id":"572d46ad4a1b7fb9","type":"join","z":"4905164f6a425bac","g":"0ace327eb24d43ce","name":"","mode":"reduce","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"","reduceRight":false,"reduceExp":"$A+payload","reduceInit":"0","reduceInitType":"num","reduceFixup":"$A/$N","x":1050,"y":460,"wires":[["507a68a3840b0349"]]}]
{% endrenderFlow %}

In the above flow, we calculate the mean of the simulated sensor data generated every second. The mean is calculated for a data batch collected over 5 seconds.

### Chain of Responsibility Pattern

The Chain of Responsibility Pattern is a design pattern used to pass a request through a series of handlers, where each handler can either process the request or pass it along to the next handler in the chain. It helps in making systems more flexible and decouples the sender of a request from its receivers. Each handler only needs to know about the next handler in the chain, not the entire process, which makes the system more modular and easier to extend or modify.

{% renderFlow %}
[{"id":"cb3398a8c0476ac3","type":"group","z":"4905164f6a425bac","name":"Chain of Responsibility Pattern","style":{"label":true},"nodes":["inject_start","switch_type_a","change_handler1","switch_type_b","change_handler2","debug_output","be26b9f1ea8e7fd3"],"x":394,"y":659,"w":1292,"h":222},{"id":"inject_start","type":"inject","z":"4905164f6a425bac","g":"cb3398a8c0476ac3","name":"Start Request","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"type\":\"urgent\",\"message\":\"Need immediate attention!\"}","payloadType":"json","x":510,"y":740,"wires":[["switch_type_a"]]},{"id":"switch_type_a","type":"switch","z":"4905164f6a425bac","g":"cb3398a8c0476ac3","name":"Check Type A","property":"payload.type","propertyType":"msg","rules":[{"t":"eq","v":"urgent","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":720,"y":800,"wires":[["change_handler1"],["switch_type_b"]]},{"id":"change_handler1","type":"change","z":"4905164f6a425bac","g":"cb3398a8c0476ac3","name":"Handler 1 - Urgent","rules":[{"t":"set","p":"payload.processedBy","pt":"msg","to":"Handler 1","tot":"str"}],"action":"update","property":"","from":"","to":"","reg":false,"x":930,"y":700,"wires":[["switch_type_b"]]},{"id":"switch_type_b","type":"switch","z":"4905164f6a425bac","g":"cb3398a8c0476ac3","name":"Check Type B","property":"payload.type","propertyType":"msg","rules":[{"t":"eq","v":"normal","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1100,"y":800,"wires":[["change_handler2"],["debug_output"]]},{"id":"change_handler2","type":"change","z":"4905164f6a425bac","g":"cb3398a8c0476ac3","name":"Handler 2 - Normal","rules":[{"t":"set","p":"payload.processedBy","pt":"msg","to":"Handler 2","tot":"str"}],"action":"update","property":"","from":"","to":"","reg":false,"x":1350,"y":720,"wires":[["debug_output"]]},{"id":"debug_output","type":"debug","z":"4905164f6a425bac","g":"cb3398a8c0476ac3","name":"Debug Output","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1560,"y":800,"wires":[]},{"id":"be26b9f1ea8e7fd3","type":"inject","z":"4905164f6a425bac","g":"cb3398a8c0476ac3","name":"Start Request","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"type\":\"normal\",\"message\":\"Doesn't need immediate attention!\"}","payloadType":"json","x":510,"y":840,"wires":[["switch_type_a"]]}]
{% endrenderFlow %}

In the above flow, the Chain of Responsibility Pattern is demonstrated with two example requests. Each handler processes the request based on its `type`. If a handler can process the request, it does so and updates the processedBy field. If not, the request is passed to the next handler in the chain.

### Timeout pattern

The Timeout Pattern is a design pattern used to handle situations where a process or operation must be completed within a specified time limit. If the operation does not complete within the given timeframe, it either fails, gets terminated, or some alternative action is taken. This pattern helps ensure that systems remain responsive and avoid hanging indefinitely due to slow or unresponsive components.

{% renderFlow %}
[{"id":"6fed8c8ebe68618f","type":"group","z":"4905164f6a425bac","name":"Timeout pattern","style":{"label":true},"nodes":["63a6c88e.9c5938","70e64796.8f19b8","823e2da8.7dc1d","5590633d.aa6f9c","331d7201.cce28e","fc008a64.03ff78","560f4353.a9f0bc","59c69b1c.a63964","cec18476.313e78","b5a00be5.4a5ff8","3a1fba6.fc5e046"],"x":694,"y":519,"w":812,"h":372.8333740234375},{"id":"63a6c88e.9c5938","type":"comment","z":"4905164f6a425bac","g":"6fed8c8ebe68618f","name":"Timeout pattern","info":"","x":820,"y":560,"wires":[]},{"id":"70e64796.8f19b8","type":"comment","z":"4905164f6a425bac","g":"6fed8c8ebe68618f","name":"When the search completes within 5 seconds, it displays the search results on the browser","info":"","x":1048.5,"y":607.9999847412109,"wires":[]},{"id":"823e2da8.7dc1d","type":"comment","z":"4905164f6a425bac","g":"6fed8c8ebe68618f","name":" ↑ If the search takes longer than 5 seconds, it displays a \"timed out\" message on the browser","info":"","x":1160,"y":850.8333740234375,"wires":[]},{"id":"5590633d.aa6f9c","type":"delay","z":"4905164f6a425bac","g":"6fed8c8ebe68618f","name":"Wait 5 Seconds","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"outputs":1,"x":924.3214111328125,"y":810.84130859375,"wires":[["331d7201.cce28e"]]},{"id":"331d7201.cce28e","type":"template","z":"4905164f6a425bac","g":"6fed8c8ebe68618f","name":"Time-out display HTML","field":"payload","format":"html","template":"\nIt Timed Out.\n","x":1130.3214111328125,"y":810.84130859375,"wires":[["cec18476.313e78"]]},{"id":"fc008a64.03ff78","type":"http in","z":"4905164f6a425bac","g":"6fed8c8ebe68618f","name":"","url":"/output","method":"get","swaggerDoc":"","x":790,"y":660,"wires":[["560f4353.a9f0bc","5590633d.aa6f9c"]]},{"id":"560f4353.a9f0bc","type":"function","z":"4905164f6a425bac","g":"6fed8c8ebe68618f","name":"Create API request URL","func":"msg.url = msg.req.host + \"/unknown?q=\" + encodeURI(msg.payload.q);\nreturn msg;","outputs":1,"noerr":0,"x":1010,"y":640,"wires":[["59c69b1c.a63964"]]},{"id":"59c69b1c.a63964","type":"http request","z":"4905164f6a425bac","g":"6fed8c8ebe68618f","name":"Call API","method":"GET","ret":"obj","url":"","x":1220,"y":640,"wires":[["b5a00be5.4a5ff8"]]},{"id":"cec18476.313e78","type":"http response","z":"4905164f6a425bac","g":"6fed8c8ebe68618f","name":"HTTP Response","x":1400,"y":780,"wires":[]},{"id":"b5a00be5.4a5ff8","type":"change","z":"4905164f6a425bac","g":"6fed8c8ebe68618f","name":"Delete headers","rules":[{"t":"delete","p":"headers"}],"action":"","property":"","from":"","to":"","reg":false,"x":980,"y":760,"wires":[["3a1fba6.fc5e046"]]},{"id":"3a1fba6.fc5e046","type":"template","z":"4905164f6a425bac","g":"6fed8c8ebe68618f","name":"Format HTML","field":"payload","format":"html","template":"\nResponse from the API: {{payload}}\n","x":1163.0000038146973,"y":766.6665773391724,"wires":[["cec18476.313e78"]]}]
{% endrenderFlow %}

In the flow above, you can how a timeout is set to handle requests that take longer than 5 seconds.

### Throttle Pattern

The throttling pattern controls the rate at which requests or operations are processed to prevent system overload. It limits the number of actions that can be performed within a specific time frame, ensuring fair resource usage and maintaining system stability. This helps manage burst traffic and protect against abuse.

{% renderFlow %}
[{"id":"6dc26a1c9ac1cc07","type":"group","z":"4905164f6a425bac","name":"Throttle Pattern","style":{"label":true},"nodes":["inject-node","http-request-node","debug-node","6d6dce8ea5b080bb"],"x":874,"y":659,"w":972,"h":82},{"id":"inject-node","type":"inject","z":"4905164f6a425bac","g":"6dc26a1c9ac1cc07","name":"Trigger Requests","props":[{"p":"payload"}],"repeat":"0.1","crontab":"","once":false,"onceDelay":"0.1","topic":"","payload":"Request Data","payloadType":"str","x":1010,"y":700,"wires":[["6d6dce8ea5b080bb"]]},{"id":"http-request-node","type":"http request","z":"4905164f6a425bac","g":"6dc26a1c9ac1cc07","name":"Make HTTP Request","method":"GET","ret":"txt","paytoqs":"ignore","url":"https://jsonplaceholder.typicode.com/todos","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":1450,"y":700,"wires":[["debug-node"]]},{"id":"debug-node","type":"debug","z":"4905164f6a425bac","g":"6dc26a1c9ac1cc07","name":"Response Output","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1710,"y":700,"wires":[]},{"id":"6d6dce8ea5b080bb","type":"delay","z":"4905164f6a425bac","g":"6dc26a1c9ac1cc07","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":1220,"y":700,"wires":[["http-request-node"]]}]
{% endrenderFlow %}

In the flow example below, we demonstrate how to implement throttling using Node-RED, which allows you to control how often HTTP requests are sent to prevent system overload.

### Retry Pattern

The retry pattern is a design pattern used to handle transient failures by automatically retrying an operation or request a specified number of times before ultimately failing. This pattern is useful in scenarios where temporary issues might cause operations to fail, such as network glitches, temporary unavailability of a service, or brief database locks.

{% renderFlow %}
[{"id":"50b54310bc44b2ce","type":"function","z":"380e37fed72e6885","name":"","func":"msg.delay = msg.retry_interval;\nmsg.retry_counter = 0;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":260,"wires":[["b4eca1de14599dd1"]]},{"id":"b4eca1de14599dd1","type":"delay","z":"380e37fed72e6885","name":"","pauseType":"delayv","timeout":"5","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":600,"y":260,"wires":[["96ca1ed69e7fa7ac"]]},{"id":"96ca1ed69e7fa7ac","type":"http request","z":"380e37fed72e6885","name":"","method":"GET","ret":"txt","paytoqs":"ignore","url":"https://jsonplaceholder.typicode.com/todos/h","tls":"","persist":false,"proxy":"","insecureHTTPParser":false,"authType":"","senderr":false,"headers":[],"x":750,"y":260,"wires":[["4442b04b4a071572"]]},{"id":"3eb4ec6b71fc383b","type":"switch","z":"380e37fed72e6885","name":"if success","property":"statusCode","propertyType":"msg","rules":[{"t":"btwn","v":"200","vt":"num","v2":"299","v2t":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1100,"y":260,"wires":[["7274b2529aab1d8d"],["bad4bdb7e00b7a80"]]},{"id":"4442b04b4a071572","type":"function","z":"380e37fed72e6885","name":"counter increment","func":"msg.retry_counter++;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":260,"wires":[["3eb4ec6b71fc383b"]]},{"id":"bad4bdb7e00b7a80","type":"switch","z":"380e37fed72e6885","name":"if max retries","property":"retry_counter","propertyType":"msg","rules":[{"t":"gte","v":"10000","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1270,"y":300,"wires":[["132f4fdc40d55e89"],["b4eca1de14599dd1"]]},{"id":"cc3c919ad9f93cc6","type":"inject","z":"380e37fed72e6885","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":220,"y":260,"wires":[["50b54310bc44b2ce"]]},{"id":"7274b2529aab1d8d","type":"debug","z":"380e37fed72e6885","name":"debug 1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1320,"y":220,"wires":[]},{"id":"132f4fdc40d55e89","type":"debug","z":"380e37fed72e6885","name":"debug 2","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1500,"y":300,"wires":[]}]
{% endrenderFlow %}

The above flow demonstrates the retry pattern by retrying HTTP requests with delays until a maximum retry limit is reached or a successful response is received.

## Best practices to follow

There are several best practices to follow when building Node-RED flows to ensure data security, maintain clarity, and enhance performance. In this section, we will review some of these practices and provide additional resources for others.

### Using Environment Variables

We always suggest using environment variables when working with nodes that require configuration details. Since this data can be sensitive, it's crucial to avoid accidentally sharing flows that contain such details. Using environment variables helps protect sensitive information and keeps your configuration secure.

For more information [Using Environment variable in Node-RED](/blog/2023/01/environment-variables-in-node-red/)

### Disabling the Node-RED Editor

Disabling the Node-RED editor can be beneficial in certain scenarios, such as when you want to prevent unauthorized access or accidental changes to your flows. This practice is particularly useful in production environments or when the Node-RED instance is exposed to the internet.

### Optimizing Flows with Distributed Tracing

Optimizing flows with distributed tracing can help in identifying and resolving performance bottlenecks. By tracing the flow of data across different nodes and services, you can gain insights into how your flows perform and make necessary adjustments to enhance efficiency.

For more information refer [Monitoring and Optimizing Node-RED Flows with Open Telemetry.](/blog/2024/08/opentelemetry-with-node-red/)

### Avoiding Unnecessary Use of Function Nodes

Minimize the use of function nodes where possible. While function nodes are powerful, excessive use can lead to complex and hard-to-maintain flows. Instead, use built-in nodes or predefined sub-flows to achieve the same functionality, which can help keep your flows more organized and easier to manage.

For more information refer to [Benefits of avoiding Function Nodes](/blog/2023/03/why-should-you-use-node-red-function-nodes/#5-benefits-of-avoiding-function-nodes%3A).

## Up Next

- [Bringing Software Development Practices to Node-RED](/blog/2024/02/software-development-in-node-red/): Explore how to apply modern software development methodologies within Node-RED for improved efficiency and maintainability.
- [Format Your Node-RED Flows for Better Team Collaboration](/blog/2022/12/node-red-flow-best-practice/): Learn best practices for organizing and documenting Node-RED flows to enhance teamwork and collaboration.
- [How to Filter, Map, Sort, and Reduce Data in Node-RED](/blog/2024/06/filtering-mapping-sorting-reducing-with-node-red/): Discover techniques for processing and manipulating data in Node-RED to streamline your workflows.